(this.webpackJsonppulse=this.webpackJsonppulse||[]).push([[0],{37:function(e,t,a){e.exports=a(53)},42:function(e,t,a){},48:function(e,t,a){},51:function(e,t,a){},53:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(33),i=a.n(s),l=(a(42),a(43),a(6)),c=a(7),o=a(9),u=a(8),m=a(11),p=a(10),h=a(16),d=a.n(h),f=a(25),b=a(29),v=a(24),E={maxzoom:9,type:"heatmap",paint:{"heatmap-weight":["interpolate",["linear"],["get","mag"],0,0,6,1],"heatmap-intensity":["interpolate",["linear"],["zoom"],0,1,9,3],"heatmap-color":["interpolate",["linear"],["heatmap-density"],0,"rgba(33,102,172,0)",.2,"rgb(103,169,207)",.4,"rgb(209,229,240)",.6,"rgb(253,219,199)",.8,"rgb(239,138,98)",.9,"rgb(255,201,101)"],"heatmap-radius":["interpolate",["linear"],["zoom"],0,2,9,20],"heatmap-opacity":["interpolate",["linear"],["zoom"],7,1,9,0]}};function y(){return(y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function w(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},s=Object.keys(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var j=r.a.createElement("g",null,r.a.createElement("path",{fill:"#00AEEF",d:"M182.9,551.7c0,0.1,0.2,0.3,0.2,0.3S358.3,283,358.3,194.6c0-130.1-88.8-186.7-175.4-186.9   C96.3,7.9,7.5,64.5,7.5,194.6c0,88.4,175.3,357.4,175.3,357.4S182.9,551.7,182.9,551.7z M122.2,187.2c0-33.6,27.2-60.8,60.8-60.8   c33.6,0,60.8,27.2,60.8,60.8S216.5,248,182.9,248C149.4,248,122.2,220.8,122.2,187.2z"})),g=function(e){var t=e.svgRef,a=e.title,n=w(e,["svgRef","title"]);return r.a.createElement("svg",y({id:"Layer_1",x:"0px",y:"0px",viewBox:"0 0 365 560",enableBackground:"new 0 0 365 560",xmlSpace:"preserve",ref:t},n),a?r.a.createElement("title",null,a):null,j)},O=r.a.forwardRef((function(e,t){return r.a.createElement(g,y({svgRef:t},e))})),k=(a.p,a(48),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={viewport:{width:window.innerWidth/2,height:window.innerHeight,latitude:37.7577,longitude:-122.4376,zoom:1}},a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(v.d,Object.assign({},this.state.viewport,{mapStyle:"mapbox://styles/mapbox/dark-v10",onViewportChange:function(t){return e.setState({viewport:t})},mapboxApiAccessToken:this.props.mapboxApiAccessToken}),this.props.heatMapData&&r.a.createElement(v.c,{type:"geojson",data:this.props.heatMapData},r.a.createElement(v.a,E)),!this.props.heatMapData&&this.props.markerCoordinateArray.map((function(e,t){return r.a.createElement(v.b,{key:t,longitude:e.lng,latitude:e.lat},r.a.createElement(O,{className:"marker-icon"}))})))}}]),t}(n.Component)),D=a(14),x=a(27),S=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).selectResult=a.selectResult.bind(Object(m.a)(a)),a.selectWidth=window.innerWidth/3,a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"selectResult",value:function(e){this.props.selectResult(this.props.data[e.target.value])}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(D.a,{className:"mb-1 mr-3",variant:"primary"},"Choose a result to see locations on map, related results and articles"),this.props.selectedResult&&r.a.createElement(x.a,{variant:"secondary",size:"sm",onClick:this.props.undoSelectedResult},"Undo selection"),r.a.createElement("div",{className:"mt-2"},r.a.createElement("select",{onChange:this.selectResult,style:{width:this.selectWidth+"px",fontSize:"11px"}},this.props.data.map((function(e,t){return r.a.createElement("option",{key:t,value:t},e.title)})))))}}]),t}(n.Component),C=a(19),R=function(e){function t(){return Object(l.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(D.a,{className:"mb-1",variant:"secondary"},"Selected result"),this.props.selectedResult?r.a.createElement(r.a.Fragment,null,r.a.createElement(C.a,{data:this.props.selectedResult})):r.a.createElement("p",null,"No result selected"))}}]),t}(n.Component),N=function(e){function t(){return Object(l.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"mt-4"},r.a.createElement(S,{undoSelectedResult:this.props.undoSelectedResult,selectResult:this.props.selectResult,selectedResult:this.props.selectedResult,data:this.props.data})),r.a.createElement("div",{className:"mt-4"},r.a.createElement(R,{selectedResult:this.props.selectedResult})))}}]),t}(n.Component),M=function(e){function t(){return Object(l.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"mt-4 mb-4"},r.a.createElement(D.a,{className:"mb-3",variant:"secondary"},"Related results based on locations"),r.a.createElement("p",null,this.props.data.total," related result",0===this.props.data.total?"":"s"),r.a.createElement(C.a,{data:this.props.data.data})))}}]),t}(n.Component),_=function(e){function t(){return Object(l.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"renderArticles",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,this.props.articles.total," related article",0===this.props.articles.total?"":"s"),r.a.createElement("p",null,"First 20 results"),r.a.createElement("ul",null,this.props.articles.data.map((function(e,t){return r.a.createElement("li",{key:t},r.a.createElement("a",{target:"_blank",href:"https://www.devex.com/news/"+e.slud_and_id},e.title))}))))}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"mt-1 mb-5"},r.a.createElement(D.a,{className:"mb-3",variant:"secondary"},"Related articles"),Object.keys(this.props.articles).length?this.renderArticles():r.a.createElement("p",null,"No related articles yet")))}}]),t}(n.Component),W=a(26),A=a(20),T=a(21),I=(a(51),function(){var e=Object(f.a)(d.a.mark((function e(t){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://www.devex.com/api/public/search/articles?".concat(t));case 3:if(!(a=e.sent).ok){e.next=8;break}return e.next=7,a.json();case 7:return e.abrupt("return",e.sent);case 8:return e.abrupt("return",a.json().then((function(e){console.log("".concat(e.error||a.status,": ").concat(e.message||a.statusText))})).catch((function(){console.log("".concat(a.status,": ").concat(a.statusText))})));case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0.toString());case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}()),B=a(52),F=function(e){var t=[];return e.forEach((function(e){Object.keys(e.locations).length&&e.locations.forEach((function(e){Object.keys(e).length&&t.push(e.location)}))})),function(e){return B.parse(e,{Point:["lat","lng"]})}(t)},z=function(e,t){var a=Y(e,t);return F(a)},Y=function(e,t){if(!t.length)return e;var a=[];return t.forEach((function(t){switch(Object.keys(t)[0]){case"news_topics":e.forEach((function(e){if(Object.keys(e.news_topics).length){var n=t.news_topics.map((function(e){return e.toLowerCase()}));e.news_topics.forEach((function(t){t.name&&n.includes(t.name.toLowerCase())&&a.push(e)}))}}));break;case"publish_date":e.forEach((function(e){var n=t.publish_date,r=n.minDate,s=n.maxDate;e.publish_date>r&&e.publish_date<s&&a.push(e)}))}})),a},J=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).backToInjector=a.backToInjector.bind(Object(m.a)(a)),a.onNewsTopicsChange=a.onNewsTopicsChange.bind(Object(m.a)(a)),a.onNewsTopicsSubmit=a.onNewsTopicsSubmit.bind(Object(m.a)(a)),a.onMaxDateChange=a.onMaxDateChange.bind(Object(m.a)(a)),a.onMinDateChange=a.onMinDateChange.bind(Object(m.a)(a)),a.onDateFilterSubmit=a.onDateFilterSubmit.bind(Object(m.a)(a)),a.state={markerCoordinateArray:[],selectedResult:null,articles:[],newsTopicsFilter:"",maxDate:"",minDate:"",heatMapData:F(a.props.data),relatedResults:{total:0,data:[]},locationNames:[],mapboxApiAccessToken:"pk.eyJ1IjoiYmJyYXNzYXJ0IiwiYSI6IjU2MTZjMjRmMjE2MmE4M2Q0OWEwMDVkYTc5YzM3M2Y3In0.V44T7lzZarK4_QwAwoEClw"},a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"backToInjector",value:function(){this.props.injectData("[]")}},{key:"onMaxDateChange",value:function(e){this.setState({maxDate:e.target.value})}},{key:"onMinDateChange",value:function(e){this.setState({minDate:e.target.value})}},{key:"onDateFilterSubmit",value:function(e){e.preventDefault();var t=this.state,a=[{publish_date:{maxDate:t.maxDate,minDate:t.minDate}}];this.setState({markerCoordinateArray:[],selectedResult:null,articles:[],relatedResults:{total:0,data:[]},newsTopicsFilter:"",heatMapData:z(this.props.data,a),locationNames:[]})}},{key:"onNewsTopicsChange",value:function(e){this.setState({newsTopicsFilter:e.target.value})}},{key:"onNewsTopicsSubmit",value:function(e){e.preventDefault();var t=[{news_topics:this.state.newsTopicsFilter.split("/")}];this.setState({markerCoordinateArray:[],selectedResult:null,articles:[],relatedResults:{total:0,data:[]},maxDate:"",minDate:"",heatMapData:z(this.props.data,t),locationNames:[]})}},{key:"extractLocationsAsNames",value:function(e){return new Set(e.locations.map((function(e){return e.name})))}},{key:"findRelatedResults",value:function(e,t){var a=this;if(!e.locations.length)return[];var n=[];return t.forEach((function(t){void 0!==t&&a.props.data.forEach((function(r){e.title!==r.title&&r.locations.length&&a.extractLocationsAsNames(r).has(t)&&(r.matches_with=t,n.push(r))}))})),new Set(n)}},{key:"generateQueryParams",value:function(e){var t=void 0===e.news_topics?[]:e.news_topics.map((function(e){return e.name.substring(5)})),a=void 0===e.locations?[]:this.extractLocationsAsNames(e),n="page[size]=20&query=".concat(encodeURIComponent(Object(b.a)(a).join("+")));return t.forEach((function(e){n+="&filter[news_topics][]=".concat(encodeURIComponent(e))})),n}},{key:"createRelatedChunks",value:function(e){var t={};return e.forEach((function(e){void 0===t[e.matches_with]?t[e.matches_with]=[e]:t[e.matches_with].push(e)})),t}},{key:"undoSelectedResult",value:function(){this.setState({markerCoordinateArray:[],selectedResult:null,newsTopicsFilter:"",articles:[],relatedResults:{total:0,data:[]},heatMapData:F(this.props.data),locationNames:[]})}},{key:"selectResult",value:function(){var e=Object(f.a)(d.a.mark((function e(t){var a,n,r,s,i,l;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.locations.length>0?new Set(t.locations.map((function(e){return e.location}))):[],n=Object(b.a)(a).filter((function(e){return null!=e})),r=this.extractLocationsAsNames(t),s=t.locations.length>0?this.findRelatedResults(t,r):[],i=Object(b.a)(s),e.next=7,I(this.generateQueryParams(t));case 7:l=e.sent,this.setState({selectedResult:t,articles:l,relatedResults:{total:i.length,data:this.createRelatedChunks(i)},maxDate:"",minDate:"",newsTopicsFilter:"",heatMapData:null,locationNames:r,markerCoordinateArray:n});case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement(W.a,{fluid:!0},r.a.createElement(A.a,null,r.a.createElement(T.a,null,r.a.createElement(x.a,{className:"mt-4",variant:"primary",onClick:this.backToInjector},"Back to injector"),r.a.createElement("div",{className:"mt-4 search-filters"},r.a.createElement(D.a,{className:"mb-2",variant:"primary"},"Filter data to modify heatmap"),r.a.createElement("div",null,r.a.createElement(D.a,{className:"mb-3",variant:"secondary"},"Filter data by publish_date")),r.a.createElement("div",null,r.a.createElement("form",{onSubmit:this.onDateFilterSubmit,style:{fontSize:"11px"}},r.a.createElement("label",null,"Min date",r.a.createElement("div",null,r.a.createElement("input",{className:"mr-4",id:"minDate",style:{width:window.innerWidth/11+"px"},type:"text",value:this.state.minDate,placeholder:"Enter min date with format YYYY-MM-DD",onChange:this.onMinDateChange}))),r.a.createElement("label",{className:"mr-2"},"Max date",r.a.createElement("div",null,r.a.createElement("input",{id:"maxDate",style:{width:window.innerWidth/11+"px"},type:"text",value:this.state.maxDate,placeholder:"Enter min date with format YYYY-MM-DD",onChange:this.onMaxDateChange}))),r.a.createElement("input",{className:"ml-3",type:"submit",value:"Filter by publish_date"}))),r.a.createElement(D.a,{className:"mb-4 mt-4",variant:"secondary"},"Filter by news topics and see heat map results"),r.a.createElement("p",{style:{fontSize:"11px"}},"Here is the list of news topics."),r.a.createElement("ul",{style:{fontSize:"11px"}},r.a.createElement("li",null,"[GH] Global Health"),r.a.createElement("li",null,"[CE] Careers & Education"),r.a.createElement("li",null,"[FU] Funding"),r.a.createElement("li",null,"[WS] Water & Sanitation")),r.a.createElement("p",{style:{fontSize:"11px"}},"You can combine them using '/'. Example of correct request: \"[GH] Global Health/[WS] Water & Sanitation\". See results on heatmap"),r.a.createElement("div",null,r.a.createElement("form",{onSubmit:this.onNewsTopicsSubmit,style:{fontSize:"11px"}},r.a.createElement("input",{style:{width:window.innerWidth/3+"px"},type:"text",value:this.state.newsTopicsFilter,placeholder:"Enter full name of one or multipe news topics (separated by /)",onChange:this.onNewsTopicsChange}),r.a.createElement("div",{className:"mt-3"},r.a.createElement("input",{type:"submit",value:"Filter by news_topics"}))))),r.a.createElement(N,{data:this.props.data,undoSelectedResult:this.undoSelectedResult.bind(this),selectResult:this.selectResult.bind(this),selectedResult:this.state.selectedResult}),r.a.createElement(M,{data:this.state.relatedResults}),r.a.createElement(_,{articles:this.state.articles})),r.a.createElement(T.a,null,r.a.createElement(k,{heatMapData:this.state.heatMapData,data:this.props.data,markerCoordinateArray:this.state.markerCoordinateArray,mapboxApiAccessToken:this.state.mapboxApiAccessToken,selectedResult:this.state.selectedResult}))))}}]),t}(n.Component),L=[{data_source:"meltwater",url:"https://www.daily-sun.com/post/435110/Bangladesh-WB-sign-100mn-financing-deal-for-safe-water-sanitation-in-municipalities",document_type:"news_article",title:"Bangladesh, WB sign $100mn financing deal for safe water, sanitation in municipalities",hit_sentence:"Bangladesh, WB sign $100mn financing deal for safe water, sanitation in municipalities",publish_date:"2019-10-29",relevant:!0,relevance_confidence:1,funders:["Asian Infrastructure Investment Bank","International Development Association","World Bank Group"],funders_new:["NCMM","Osun State Government","World Bank Country Director for Bangladesh","World Bank\u2019s International Development Association","government of Bangladesh"],companies:["Asian Infrastructure Investment Bank","Bhutan Mercy Tembon","ERD","National Strategy for Water Supply and Sanitation","WB","World Bank","World Bank 's International Development Association"],news_topics:[{confidence:.985,name:"[WS] Water & Sanitation"},{confidence:.773,name:"[IN] Infrastructure"},{confidence:.75,name:"[UD] Urban Development"}],wb_sectors:[{confidence:.903,name:"[WC] Water supply"},{confidence:.775,name:"[WA] Sanitation"},{confidence:.634,name:"[WV] Wastewater Treatment and Disposal"}],locations:[{location:{lat:23.684994,lng:90.356331},name:"Bangladesh"}]}],U=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={jsonData:""},a.submitData=a.submitData.bind(Object(m.a)(a)),a.handleInjectedDataChange=a.handleInjectedDataChange.bind(Object(m.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"submitData",value:function(e){e.preventDefault(),this.props.injectData(this.state.jsonData)}},{key:"handleInjectedDataChange",value:function(e){this.setState({jsonData:e.target.value})}},{key:"render",value:function(){return r.a.createElement(W.a,{className:"mt-4"},r.a.createElement(A.a,null,r.a.createElement(T.a,null,r.a.createElement("h2",{className:"m-3"},"Copy paste compatible JSON data first"))),r.a.createElement(A.a,null,r.a.createElement(T.a,null,r.a.createElement("form",{className:"m-4",onSubmit:this.submitData},r.a.createElement("textarea",{style:{width:window.innerWidth/4+"px",height:window.innerWidth/4+"px"},placeholder:"Insert your JSON data here",onChange:this.handleInjectedDataChange}),r.a.createElement("div",{className:"mt-3"},r.a.createElement("input",{type:"submit",value:"Inject JSON data"}))))),r.a.createElement(A.a,{className:"mt-5"},r.a.createElement("p",null,"Example of compatible JSON data"),r.a.createElement(C.a,{data:L,expandLevel:10})))}}]),t}(n.Component),G=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).injectData=a.injectData.bind(Object(m.a)(a)),a.state={data:[]},a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"injectData",value:function(e){this.setState({data:JSON.parse(e)})}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,this.state.data.length?r.a.createElement(J,{injectData:this.injectData,data:this.state.data}):r.a.createElement(U,{injectData:this.injectData}))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(G,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[37,1,2]]]);
//# sourceMappingURL=main.ffa55719.chunk.js.map